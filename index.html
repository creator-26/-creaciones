<!doctype html>

<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lista de Deudas (S/)</title>
  <style>
    :root{
      --bg:#ffffff;--fg:#111827;--muted:#6b7280;--green:#10b981;--red:#ef4444;--card:#f9fafb;--line:#e5e7eb;--shadow:0 8px 24px rgba(0,0,0,.06)
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif}
    .wrap{max-width:720px;margin:auto;padding:24px}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:16px}
    h1{font-size:22px;margin:0}
    .hint{color:var(--muted);font-size:14px}
    .card{background:#fff;border:1px solid var(--line);border-radius:16px;box-shadow:var(--shadow)}
    .bar{display:grid;grid-template-columns:1fr auto;gap:8px;padding:14px;border-bottom:1px solid var(--line)}
    .bar input[type="text"], .bar input[type="number"]{width:100%;padding:12px 14px;border:1px solid var(--line);border-radius:12px;background:#fff}
    .bar button{padding:12px 16px;border:0;border-radius:12px;background:#111827;color:#fff;cursor:pointer}
    .bar button:active{transform:translateY(1px)}.list{list-style:none;margin:0;padding:0}
.row{display:grid;grid-template-columns:120px 1fr 88px 44px;align-items:center;gap:10px;padding:14px 14px;border-top:1px solid var(--line)}
.row:first-child{border-top:0}

.amountBox{position:relative}
.amountBox::before{content:"S/ ";position:absolute;left:12px;top:50%;transform:translateY(-50%);color:var(--muted)}
.amount {
  width: 100%;
  padding: 12px 5px 12px 24px; /* espacio extra para el S/ */
  border: 2px solid var(--line);
  border-radius: 12px;
  background: #fff;

}
.amount[readonly]{border-color:transparent;background:var(--card)}

.name{padding:12px;border:1px solid transparent;border-radius:12px}
.name[contenteditable="true"]{background:var(--card);border-color:var(--line)}

.statusBtn{display:flex;align-items:center;justify-content:center;height:40px;border-radius:12px;border:1px solid var(--line);background:#fff;cursor:pointer}
.statusBtn.paid{background:rgba(16,185,129,.1);border-color:rgba(16,185,129,.4)}
.statusBtn.pending{background:rgba(239,68,68,.08);border-color:rgba(239,68,68,.3)}
.statusIcon{font-size:18px}

.delBtn{height:40px;border-radius:12px;border:1px solid var(--line);background:#fff;cursor:pointer}
.delBtn:active,.statusBtn:active{transform:translateY(1px)}

.totals{display:flex;gap:16px;flex-wrap:wrap;padding:14px;border-top:1px solid var(--line);background:var(--card);border-radius:0 0 16px 16px}
.pill{padding:8px 12px;border-radius:999px;background:#fff;border:1px solid var(--line)}
.muted{color:var(--muted)}
.empty{padding:18px;text-align:center;color:var(--muted)}

@media (max-width:520px){
  .row{grid-template-columns:1fr 1fr 56px 40px}
  .amountBox::before{left:10px}
}

  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Lista de deudas</h1>
      <div class="hint">Todo en <strong>S/</strong>. Toca para editar.</div>
    </header><div class="card" id="app">
  <div class="bar">
    <div style="display:grid;grid-template-columns:1fr 140px;gap:8px;width:100%">
      <input id="nameInput" type="text" placeholder="Nombre / Motivo (ej. Juan - pr√©stamo)" />
      <input id="amountInput" type="number" step="0.01" min="0" placeholder="Monto" />
    </div>
    <button id="addBtn">A√±adir</button>
  </div>

  <ul class="list" id="list"></ul>

  <div class="totals">
    <div class="pill"><span class="muted">Pendiente:</span> <strong id="sumPending">S/ 0.00</strong></div>
    <div class="pill"><span class="muted">Cobrado:</span> <strong id="sumPaid">S/ 0.00</strong></div>
    <div class="pill"><span class="muted">Total:</span> <strong id="sumTotal">S/ 0.00</strong></div>
  </div>
</div>

  </div>  <script>
    const PEN = new Intl.NumberFormat('es-PE', { style: 'currency', currency: 'PEN' });
    const $ = (sel, el=document) => el.querySelector(sel);
    const listEl = $('#list');
    const nameInput = $('#nameInput');
    const amountInput = $('#amountInput');
    const addBtn = $('#addBtn');

    const SKEY = 'debt-list-v1';
    let items = [];

    function save(){ localStorage.setItem(SKEY, JSON.stringify(items)); }
    function load(){ items = JSON.parse(localStorage.getItem(SKEY)||'[]'); }

    function addItem(name, amount){
      if(!name) name = 'Sin nombre';
      const amt = Number(amount)||0;
      items.unshift({ id: crypto.randomUUID(), name, amount: amt, paid: false, created: Date.now() });
      save();
      render();
    }

    function delItem(id){ items = items.filter(x=>x.id!==id); save(); render(); }

    function togglePaid(id){ const it = items.find(x=>x.id===id); if(it){ it.paid=!it.paid; save(); render(); } }

    function updateName(id, name){ const it = items.find(x=>x.id===id); if(it){ it.name=name.trim()||'Sin nombre'; save(); }}

    function updateAmount(id, amount){ const it = items.find(x=>x.id===id); if(it){ it.amount = Number(amount)||0; save(); renderSums(); }}

    function renderSums(){
      const sumPending = items.filter(i=>!i.paid).reduce((a,b)=>a+b.amount,0);
      const sumPaid = items.filter(i=>i.paid).reduce((a,b)=>a+b.amount,0);
      $('#sumPending').textContent = PEN.format(sumPending);
      $('#sumPaid').textContent = PEN.format(sumPaid);
      $('#sumTotal').textContent = PEN.format(sumPending+sumPaid);
    }

    function rowTemplate(item){
      const li = document.createElement('li');
      li.className = 'row';

      // Amount (editable input with S/ prefix)
      const amountBox = document.createElement('div');
      amountBox.className = 'amountBox';
      const amt = document.createElement('input');
      amt.type = 'number';
      amt.step = '0.01';
      amt.min = '0';
      amt.className = 'amount';
      amt.value = item.amount.toFixed(2);
      amt.addEventListener('change', () => updateAmount(item.id, amt.value));
      amountBox.appendChild(amt);

      // Name (contenteditable)
      const name = document.createElement('div');
      name.className = 'name';
      name.textContent = item.name;
      name.contentEditable = 'true';
      name.spellcheck = false;
      let nameDebounce;
      name.addEventListener('input', () => {
        clearTimeout(nameDebounce);
        nameDebounce = setTimeout(()=>updateName(item.id, name.textContent), 300);
      });

      // Status button
      const statusBtn = document.createElement('button');
      statusBtn.className = 'statusBtn ' + (item.paid ? 'paid' : 'pending');
      statusBtn.title = item.paid ? 'Cobrado' : 'Pendiente';
      const icon = document.createElement('span');
      icon.className = 'statusIcon';
      icon.textContent = item.paid ? '‚úì' : '‚úó';
      statusBtn.appendChild(icon);
      statusBtn.addEventListener('click', ()=> togglePaid(item.id));

      // Delete button
      const del = document.createElement('button');
      del.className = 'delBtn';
      del.title = 'Eliminar';
      del.textContent = 'üóëÔ∏è';
      del.addEventListener('click', ()=> delItem(item.id));

      li.append(amountBox, name, statusBtn, del);
      return li;
    }

    function render(){
      listEl.innerHTML='';
      if(items.length===0){
        const empty = document.createElement('div');
        empty.className='empty';
        empty.textContent = 'A√∫n no hay deudas. A√±ade la primera arriba.';
        listEl.appendChild(empty);
      } else {
        // Unpaid first
        const sorted = [...items].sort((a,b)=> Number(a.paid) - Number(b.paid) || b.created - a.created);
        sorted.forEach(it=> listEl.appendChild(rowTemplate(it)));
      }
      renderSums();
    }

    addBtn.addEventListener('click', ()=>{
      addItem(nameInput.value.trim(), amountInput.value);
      nameInput.value=''; amountInput.value='';
      nameInput.focus();
    });
    amountInput.addEventListener('keydown', e=>{ if(e.key==='Enter') addBtn.click(); });
    nameInput.addEventListener('keydown', e=>{ if(e.key==='Enter'){ e.preventDefault(); amountInput.focus(); } });

    // Init
    load();
    if(items.length===0){
      addItem('Ejemplo: Juan - pr√©stamo', 50);
      items[0].paid=false; save();
    } else { render(); }
  </script></body>
</html>