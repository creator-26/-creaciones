
-- AUTO KILL SUPREMO HORIZONTAL - VERSIÃ“N DEFINITIVA
-- Hub horizontal 500x320 | Lista derecha | Funciones 100% funcionales

local Players = game:GetService("Players")
local StarterGui = game:GetService("StarterGui")
local Camera = workspace.CurrentCamera
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")

-- VARIABLES GLOBALES
_G.AutoKillEnabled = false
_G.AutoKillAll = true
_G.TargetPlayerName = ""
_G.Whitelist = {"MissSherya"}
_G.SpectatingPlayer = nil
_G.AutoAttackConnection = nil
_G.AutoSpectateConnection = nil

-- ================== FUNCIONES BÃSICAS ==================
local function isWhitelisted(plr)
    for _, name in ipairs(_G.Whitelist) do
        if plr.Name:lower() == name:lower() then
            return true
        end
    end
    return false
end

local function equipPunch()
    if not LocalPlayer.Character then return false end
    local char = LocalPlayer.Character
    
    -- Verificar si ya tiene el puÃ±o
    if char:FindFirstChild("Punch") then
        return true
    end
    
    -- Buscar en el inventario
    local backpack = LocalPlayer.Backpack
    local punch = backpack:FindFirstChild("Punch")
    
    if punch then
        punch.Parent = char
        return true
    end
    
    return false
end

local function getValidTargets()
    local targets = {}
    
    if _G.AutoKillAll then
        -- Atacar a todos excepto whitelist y yo mismo
        for _, player in pairs(Players:GetPlayers()) do
            if player == LocalPlayer then continue end
            if isWhitelisted(player) then continue end
            
            local char = player.Character
            if char then
                local humanoid = char:FindFirstChild("Humanoid")
                local root = char:FindFirstChild("HumanoidRootPart")
                
                if humanoid and root and humanoid.Health > 0 then
                    table.insert(targets, {
                        Player = player,
                        Character = char,
                        Humanoid = humanoid,
                        RootPart = root
                    })
                end
            end
        end
    elseif _G.TargetPlayerName ~= "" then
        -- Atacar solo al objetivo especificado
        for _, player in pairs(Players:GetPlayers()) do
            if player == LocalPlayer then continue end
            if not player.Name:lower():find(_G.TargetPlayerName:lower()) then continue end
            
            local char = player.Character
            if char then
                local humanoid = char:FindFirstChild("Humanoid")
                local root = char:FindFirstChild("HumanoidRootPart")
                
                if humanoid and root and humanoid.Health > 0 then
                    table.insert(targets, {
                        Player = player,
                        Character = char,
                        Humanoid = humanoid,
                        RootPart = root
                    })
                end
            end
            break -- Solo un objetivo
        end
    end
    
    return targets
end

-- ================== SISTEMA DE AUTO KILL MEJORADO ==================
local function startAutoKill()
    if _G.AutoAttackConnection then
        _G.AutoAttackConnection:Disconnect()
        _G.AutoAttackConnection = nil
    end
    
    _G.AutoAttackConnection = RunService.Heartbeat:Connect(function(deltaTime)
        if not _G.AutoKillEnabled then return end
        if not LocalPlayer.Character then return end
        
        -- Equipar puÃ±os primero
        equipPunch()
        
        local myChar = LocalPlayer.Character
        local leftHand = myChar:FindFirstChild("LeftHand")
        local rightHand = myChar:FindFirstChild("RightHand")
        
        if not leftHand and not rightHand then return end
        
        -- Obtener objetivos vÃ¡lidos
        local targets = getValidTargets()
        
        -- Atacar a cada objetivo
        for _, target in ipairs(targets) do
            -- Verificar que el objetivo aÃºn sea vÃ¡lido
            if target.Humanoid and target.Humanoid.Health > 0 then
                -- Usar el evento de golpe del juego
                pcall(function()
                    LocalPlayer.muscleEvent:FireServer("punch", "leftHand")
                    LocalPlayer.muscleEvent:FireServer("punch", "rightHand")
                end)
                
                -- Usar firetouchinterest para contacto
                if leftHand then
                    firetouchinterest(leftHand, target.RootPart, 0)
                    firetouchinterest(leftHand, target.RootPart, 1)
                end
                
                if rightHand then
                    firetouchinterest(rightHand, target.RootPart, 0)
                    firetouchinterest(rightHand, target.RootPart, 1)
                end
                
                -- PequeÃ±a pausa para evitar sobrecarga
                task.wait(0.05)
            end
        end
    end)
end

local function stopAutoKill()
    if _G.AutoAttackConnection then
        _G.AutoAttackConnection:Disconnect()
        _G.AutoAttackConnection = nil
    end
end

-- ================== SISTEMA DE ESPECTEO ==================
local function updateSpectate()
    if _G.AutoSpectateConnection then
        _G.AutoSpectateConnection:Disconnect()
        _G.AutoSpectateConnection = nil
    end
    
    _G.AutoSpectateConnection = RunService.Heartbeat:Connect(function()
        if _G.SpectatingPlayer and _G.SpectatingPlayer ~= LocalPlayer then
            if _G.SpectatingPlayer.Character then
                local humanoid = _G.SpectatingPlayer.Character:FindFirstChild("Humanoid")
                if humanoid and Camera.CameraSubject ~= humanoid then
                    Camera.CameraSubject = humanoid
                end
            end
        end
    end)
end

-- ================== INTERFAZ HORIZONTAL 500x320 ==================
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AutoKillHubHorizontal"
screenGui.ResetOnSpawn = false
screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

-- Frame principal horizontal (500x320)
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 500, 0, 320)
mainFrame.Position = UDim2.new(0.5, -250, 0.5, -160)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Visible = false
mainFrame.Parent = screenGui

-- TÃ­tulo
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 30)
title.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
title.Text = "AUTO KILL SUPREMO - HORIZONTAL"
title.TextColor3 = Color3.new(1,1,1)
title.Font = Enum.Font.GothamBold
title.TextSize = 16
title.Parent = mainFrame

-- ================== PANEL IZQUIERDO (Controles) ==================
local leftPanel = Instance.new("Frame")
leftPanel.Size = UDim2.new(0, 230, 1, -40)
leftPanel.Position = UDim2.new(0, 10, 0, 40)
leftPanel.BackgroundTransparency = 1
leftPanel.Parent = mainFrame

local controlY = 0

-- BotÃ³n Auto Kill ON/OFF
local btnToggle = Instance.new("TextButton")
btnToggle.Size = UDim2.new(1, 0, 0, 35)
btnToggle.Position = UDim2.new(0, 0, 0, controlY)
btnToggle.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
btnToggle.Text = "ðŸ”´ AUTO KILL: OFF"
btnToggle.TextSize = 14
btnToggle.Font = Enum.Font.GothamBold
btnToggle.Parent = leftPanel
controlY += 40

-- BotÃ³n Modo Todos/Individual
local btnMode = Instance.new("TextButton")
btnMode.Size = UDim2.new(1, 0, 0, 35)
btnMode.Position = UDim2.new(0, 0, 0, controlY)
btnMode.BackgroundColor3 = Color3.fromRGB(0, 120, 200)
btnMode.Text = "ðŸŽ¯ MODO: TODOS"
btnMode.TextSize = 14
btnMode.Parent = leftPanel
controlY += 40

-- Campo para nombre especÃ­fico
local txtTarget = Instance.new("TextBox")
txtTarget.Size = UDim2.new(1, 0, 0, 35)
txtTarget.Position = UDim2.new(0, 0, 0, controlY)
txtTarget.PlaceholderText = "Nombre del jugador..."
txtTarget.TextSize = 14
txtTarget.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
txtTarget.TextColor3 = Color3.new(1,1,1)
txtTarget.Parent = leftPanel
controlY += 40

-- Campo para whitelist
local txtWhitelist = Instance.new("TextBox")
txtWhitelist.Size = UDim2.new(1, 0, 0, 35)
txtWhitelist.Position = UDim2.new(0, 0, 0, controlY)
txtWhitelist.PlaceholderText = "Agregar a Whitelist..."
txtWhitelist.TextSize = 14
txtWhitelist.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
txtWhitelist.TextColor3 = Color3.new(1,1,1)
txtWhitelist.Parent = leftPanel
controlY += 40

-- BotÃ³n Actualizar Lista
local btnRefresh = Instance.new("TextButton")
btnRefresh.Size = UDim2.new(1, 0, 0, 35)
btnRefresh.Position = UDim2.new(0, 0, 0, controlY)
btnRefresh.BackgroundColor3 = Color3.fromRGB(150, 0, 200)
btnRefresh.Text = "ðŸ”„ Actualizar Lista"
btnRefresh.TextSize = 14
btnRefresh.Parent = leftPanel

-- ================== PANEL DERECHO (Lista de jugadores) ==================
local rightPanel = Instance.new("Frame")
rightPanel.Size = UDim2.new(0, 240, 0, 250)
rightPanel.Position = UDim2.new(0, 250, 0, 40)
rightPanel.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
rightPanel.Parent = mainFrame

-- Lista desplazable
local playerList = Instance.new("ScrollingFrame")
playerList.Size = UDim2.new(1, -10, 1, -10)
playerList.Position = UDim2.new(0, 5, 0, 5)
playerList.BackgroundTransparency = 1
playerList.ScrollBarThickness = 6
playerList.Parent = rightPanel

local listLayout = Instance.new("UIListLayout")
listLayout.Padding = UDim.new(0, 2)
listLayout.Parent = playerList

-- ================== FUNCIONALIDAD DE LA LISTA ==================
local function updatePlayerList()
    -- Limpiar lista actual
    for _, child in ipairs(playerList:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    -- BotÃ³n "Dejar de Espectear"
    local noneBtn = Instance.new("TextButton")
    noneBtn.Size = UDim2.new(1, 0, 0, 30)
    noneBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
    noneBtn.Text = "[Dejar de Espectear]"
    noneBtn.TextColor3 = Color3.new(1,1,1)
    noneBtn.TextSize = 12
    noneBtn.Parent = playerList
    
    noneBtn.MouseButton1Click:Connect(function()
        _G.SpectatingPlayer = nil
        if LocalPlayer.Character then
            local humanoid = LocalPlayer.Character:FindFirstChild("Humanoid")
            if humanoid then
                Camera.CameraSubject = humanoid
            end
        end
        updatePlayerList()
    end)
    
    -- Agregar jugadores
    for _, player in pairs(Players:GetPlayers()) do
        local btn = Instance.new("TextButton")
        btn.Size = UDim2.new(1, 0, 0, 28)
        
        local isMe = player == LocalPlayer
        local isWhitelistedPlayer = isWhitelisted(player)
        local isSpectating = _G.SpectatingPlayer == player
        
        if isMe then
            btn.BackgroundColor3 = Color3.fromRGB(0, 120, 0)
            btn.Text = player.Name .. " (TÃš)"
        elseif isWhitelistedPlayer then
            btn.BackgroundColor3 = Color3.fromRGB(120, 0, 120)
            btn.Text = player.Name .. " (WHITELIST)"
        elseif isSpectating then
            btn.BackgroundColor3 = Color3.fromRGB(255, 80, 0)
            btn.Text = player.Name .. " [ESP]"
        else
            btn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
            btn.Text = player.Name
        end
        
        btn.TextColor3 = Color3.new(1,1,1)
        btn.TextSize = 12
        btn.Parent = playerList
        
        -- Configurar clic
        if not isMe then
            btn.MouseButton1Click:Connect(function()
                if not isWhitelistedPlayer then
                    -- Establecer como objetivo
                    _G.TargetPlayerName = player.Name
                    _G.AutoKillAll = false
                    txtTarget.Text = player.Name
                    btnMode.Text = "ðŸŽ¯ MODO: INDIVIDUAL"
                    btnMode.BackgroundColor3 = Color3.fromRGB(200, 100, 0)
                    
                    StarterGui:SetCore("SendNotification", {
                        Title = "Objetivo Establecido",
                        Text = "Atacando a: " .. player.Name,
                        Duration = 3
                    })
                end
                
                -- Espectear
                _G.SpectatingPlayer = player
                updateSpectate()
                updatePlayerList()
            end)
        end
    end
    
    playerList.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y)
end

-- ================== FUNCIONES DE LOS CONTROLES ==================
btnToggle.MouseButton1Click:Connect(function()
    _G.AutoKillEnabled = not _G.AutoKillEnabled
    
    if _G.AutoKillEnabled then
        btnToggle.Text = "âœ… AUTO KILL: ON"
        btnToggle.BackgroundColor3 = Color3.fromRGB(0, 180, 0)
        startAutoKill()
        
        local modeText = _G.AutoKillAll and "TODOS" or "INDIVIDUAL"
        StarterGui:SetCore("SendNotification", {
            Title = "Auto Kill Activado",
            Text = "Modo: " .. modeText,
            Duration = 3
        })
    else
        btnToggle.Text = "ðŸ”´ AUTO KILL: OFF"
        btnToggle.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
        stopAutoKill()
    end
end)

btnMode.MouseButton1Click:Connect(function()
    _G.AutoKillAll = not _G.AutoKillAll
    
    if _G.AutoKillAll then
        btnMode.Text = "ðŸŽ¯ MODO: TODOS"
        btnMode.BackgroundColor3 = Color3.fromRGB(0, 120, 200)
        StarterGui:SetCore("SendNotification", {
            Title = "Modo Cambiado",
            Text = "AtacarÃ¡s a TODOS los jugadores",
            Duration = 3
        })
    else
        btnMode.Text = "ðŸŽ¯ MODO: INDIVIDUAL"
        btnMode.BackgroundColor3 = Color3.fromRGB(200, 100, 0)
        if _G.TargetPlayerName ~= "" then
            StarterGui:SetCore("SendNotification", {
                Title = "Modo Cambiado",
                Text = "AtacarÃ¡s a: " .. _G.TargetPlayerName,
                Duration = 3
            })
        end
    end
end)

txtTarget.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        _G.TargetPlayerName = txtTarget.Text
        if _G.TargetPlayerName ~= "" then
            _G.AutoKillAll = false
            btnMode.Text = "ðŸŽ¯ MODO: INDIVIDUAL"
            btnMode.BackgroundColor3 = Color3.fromRGB(200, 100, 0)
            
            StarterGui:SetCore("SendNotification", {
                Title = "Objetivo Establecido",
                Text = "Atacando a: " .. _G.TargetPlayerName,
                Duration = 3
            })
        end
    end
end)

txtWhitelist.FocusLost:Connect(function(enterPressed)
    if enterPressed and txtWhitelist.Text ~= "" then
        table.insert(_G.Whitelist, txtWhitelist.Text)
        StarterGui:SetCore("SendNotification", {
            Title = "Whitelist Actualizada",
            Text = "Agregado: " .. txtWhitelist.Text,
            Duration = 3
        })
        txtWhitelist.Text = ""
        updatePlayerList()
    end
end)

btnRefresh.MouseButton1Click:Connect(function()
    updatePlayerList()
    StarterGui:SetCore("SendNotification", {
        Title = "Lista Actualizada",
        Text = "Jugadores actualizados",
        Duration = 2
    })
end)

-- ================== BOTONES DE CONTROL ==================
local btnClose = Instance.new("TextButton")
btnClose.Size = UDim2.new(0, 25, 0, 25)
btnClose.Position = UDim2.new(1, -30, 0, 3)
btnClose.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
btnClose.Text = "X"
btnClose.TextSize = 14
btnClose.Parent = mainFrame

local floatBtn = Instance.new("TextButton")
floatBtn.Size = UDim2.new(0, 50, 0, 50)
floatBtn.Position = UDim2.new(0.95, -50, 0.01, 40)
floatBtn.BackgroundColor3 = Color3.fromRGB(0, 180, 0)
floatBtn.Text = "HUB"
floatBtn.TextSize = 14
floatBtn.Font = Enum.Font.GothamBold
floatBtn.Parent = screenGui

-- ================== EVENTOS DE BOTONES ==================
btnClose.MouseButton1Click:Connect(function()
    mainFrame.Visible = false
end)

floatBtn.MouseButton1Click:Connect(function()
    mainFrame.Visible = not mainFrame.Visible
    if mainFrame.Visible then
        updatePlayerList()
    end
end)

-- ================== DISEÃ‘O Y ESQUINAS REDONDEADAS ==================
local function applyCorners(object)
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = object
end

applyCorners(mainFrame)
applyCorners(rightPanel)
applyCorners(floatBtn)

for _, obj in ipairs(mainFrame:GetChildren()) do
    if obj:IsA("TextButton") or obj:IsA("TextBox") then
        applyCorners(obj)
    end
end

for _, obj in ipairs(leftPanel:GetChildren()) do
    if obj:IsA("TextButton") or obj:IsA("TextBox") then
        applyCorners(obj)
    end
end

-- ================== INICIALIZACIÃ“N ==================
updatePlayerList()

-- Auto-update la lista cada 10 segundos cuando estÃ© visible
task.spawn(function()
    while true do
        task.wait(10)
        if mainFrame.Visible then
            updatePlayerList()
        end
    end
end)

-- NotificaciÃ³n de carga
StarterGui:SetCore("SendNotification", {
    Title = "AUTO KILL DEFINITIVO",
    Text = "Hub horizontal cargado | Todas las funciones activas",
    Duration = 5
})

print("=== AUTO KILL HUB HORIZONTAL CARGADO ===")
print("â€¢ Auto Kill AutomÃ¡tico: âœ“")
print("â€¢ Lista de Jugadores: âœ“")
print("â€¢ Especteo Persistente: âœ“")
print("â€¢ DiseÃ±o Horizontal 500x320: âœ“")
